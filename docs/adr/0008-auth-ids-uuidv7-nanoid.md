# ADR 0008: Auth and Public IDs (UUID v7 + NanoID)

Date: 2026-02-14
Status: Accepted

## Context

We want stable, index-friendly primary keys while keeping URLs short and user-friendly. Postgres 18 supports `uuidv7()` for time-ordered UUIDs, and we want to avoid exposing UUIDs directly in URLs.

## Decision

- Use **UUID v7** for primary keys (DB defaults via `uuidv7()` where applicable).
- Use **NanoID** (lowercase, length 20, custom alphabet) for public URL identifiers.
- Better Auth schema uses UUIDs generated by the DB; a postprocess step replaces `gen_random_uuid()` with `uuidv7()`.

## Alternatives Considered

- UUID v4 everywhere (easy, less index locality).
- NanoID as the only ID (URL-friendly but not time-ordered).
- CUID2 for public IDs (URL-friendly, not time-ordered).

## Consequences

- Positive: Time-ordered IDs improve index locality and ordering; URLs remain clean.
- Negative: Requires a postprocess step after Better Auth schema generation.
- Follow-ups: Add NanoID helper and apply pattern to domain tables.
